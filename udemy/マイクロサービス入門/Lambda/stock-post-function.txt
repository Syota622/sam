const { DynamoDBClient } = require("@aws-sdk/client-dynamodb");
const { DynamoDBDocumentClient, PutCommand } = require("@aws-sdk/lib-dynamodb");

const client = new DynamoDBClient({});
const dynamoDb = DynamoDBDocumentClient.from(client);

module.exports.handler = (event, context) => {
  // JSONをJSのオブジェクトに変換
  const data = JSON.parse(event.body);

  // テーブル名(TableName)と各カラム(Item)のオブジェクト
  const params = { 
    TableName: "stock",
    Item: {
      id: data.id,
      number: data.number,
    },
  };

  // DynamoDBへのデータ登録
  dynamoDb.send(new PutCommand(params), function(err, data) {
    if (err) {
      context.fail(err); // エラー時
    } else {
      JSON.stringify(context.succeed(data.Item)); // 正常時
    }
  });
};